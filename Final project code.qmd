---
title: "Project code"
format: html
---

```{r}
library(readr)
library(janitor)
library(dplyr)
library(performance)
library(patchwork)
library(see)
library(ggplot2)
library(here)
library(car)
library(GGally)
library(modelsummary)
```

```{r}
Life_Expectancy <- read_csv(here("Life_Expectancy_00_15.csv"))
Life<-clean_names(Life_Expectancy)
Life<-Life|>filter(year==2015)
```

```{r}
gdp_reg<-lm(data=Life,life_expectancy~gdp_per_capita)
summary(gdp_reg)

health_reg<-lm(data=Life,life_expectancy~health_expenditure)
summary(health_reg)

co2_reg <- lm(data = Life, life_expectancy ~ co2_emissions)
summary(co2_reg)

# military_reg <- lm(data = Life, life_expectancy ~ military_expenditure)
# summary(military_reg)

water_reg <- lm(data=Life, life_expectancy ~ people_using_at_least_basic_drinking_water_services)
summary(water_reg)

defacation_reg <- lm(data = Life, life_expectancy ~ people_practicing_open_defecation)
summary(defacation_reg)

```

```{r}
additive<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + co2_emissions + people_using_at_least_basic_drinking_water_services + people_practicing_open_defecation )
summary(additive)

additive2<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + co2_emissions + people_using_at_least_basic_drinking_water_services )
summary(additive2)

additive3<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services )
summary(additive3)

additive4<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services +least_developed+continent)
summary(additive4)
check_model(additive4, check = c("ncv","homogeneity","qq"))
vif(additive4)

#just numeric variable
additive5<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services)
summary(additive5)
check_model(additive5, check = c("ncv","homogeneity","qq"))
anova(additive5,additive4)

interaction1<-lm(data = Life, life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services *least_developed)
summary(interaction1)
anova(additive4, interaction1)
check_model(interaction1, check = c("ncv","homogeneity","qq"))
vif(interaction1) 
#high vif
interaction2<-lm(data = Life, life_expectancy ~ gdp_per_capita * least_developed+ health_expenditure + people_using_at_least_basic_drinking_water_services)
summary(interaction2)
vif(interaction2)
anova(additive4, interaction2)
check_model(interaction2, check = c("ncv","homogeneity","qq"))
#high vif and insignificant interaction term
#both interaction is not good 

```

```{r}
library(tidyverse)
library(emmeans)
```

```{r}
continents_health<-lm(data=Life,life_expectancy~continent + health_expenditure)
summary(continents_health)
#africa is the baseline group

continents_gdp<-lm(data=Life,life_expectancy~continent + gdp_per_capita)
summary(continents_gdp)

continents_drinking<-lm(data=Life,life_expectancy~continent + people_using_at_least_basic_drinking_water_services )
summary(continents_drinking)
```

```{r}

mean_health_expenditure=mean(Life$health_expenditure)
health_grid<- emmeans(continents_health, specs = ~ continent,at =mean_health_expenditure)
contrast(health_grid, method = "pairwise")

mean_gdp=mean(Life$gdp_per_capita)
gdp_grid<- emmeans(continents_gdp, specs = ~ continent,at =mean_gdp)
contrast(gdp_grid, method = "pairwise")

mean_drinking=mean(Life$people_using_at_least_basic_drinking_water_services)
drinking_grid<- emmeans(continents_drinking, specs = ~ continent,at =mean_drinking)
contrast(drinking_grid, method = "pairwise")

```

```{r}
developed_health<-lm(data=Life,life_expectancy~least_developed + health_expenditure)
summary(developed_health)
#africa is the baseline group

developed_gdp<-lm(data=Life,life_expectancy~least_developed + gdp_per_capita)
summary(developed_gdp)

developed_drinking<-lm(data=Life,life_expectancy~least_developed + people_using_at_least_basic_drinking_water_services )
summary(developed_drinking)
```

```{r}
developed_health_grid<- emmeans(developed_health, specs = ~ least_developed,at =mean_health_expenditure)
contrast(developed_health_grid, method = "pairwise")

developed_gdp_grid<- emmeans(developed_gdp, specs = ~ least_developed,at =mean_gdp)
contrast(developed_gdp_grid, method = "pairwise")

developed_drinking_grid<- emmeans(developed_drinking, specs = ~ least_developed,at =mean_drinking)
contrast(developed_drinking_grid, method = "pairwise")
```

