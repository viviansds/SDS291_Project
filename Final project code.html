<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Project code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Final project code_files/libs/clipboard/clipboard.min.js"></script>
<script src="Final project code_files/libs/quarto-html/quarto.js"></script>
<script src="Final project code_files/libs/quarto-html/popper.min.js"></script>
<script src="Final project code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Final project code_files/libs/quarto-html/anchor.min.js"></script>
<link href="Final project code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Final project code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Final project code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Final project code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Final project code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project code</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/liuzhirou/Desktop/SDS291_Project</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Life_Expectancy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"Life_Expectancy_00_15.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1904 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (2): Country, Continent
dbl (14): Year, Life Expectancy, Population, CO2 emissions, Health expenditu...
lgl  (1): Least Developed

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Life<span class="ot">&lt;-</span><span class="fu">clean_names</span>(Life_Expectancy)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Life<span class="ot">&lt;-</span>Life<span class="sc">|&gt;</span><span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2015</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gdp_reg<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Life,life_expectancy<span class="sc">~</span>gdp_per_capita)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita, data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.180  -2.749   1.237   3.726   7.404 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6.796e+01  6.989e-01   97.24   &lt;2e-16 ***
gdp_per_capita 2.459e-04  2.392e-05   10.28   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.091 on 117 degrees of freedom
Multiple R-squared:  0.4746,    Adjusted R-squared:  0.4701 
F-statistic: 105.7 on 1 and 117 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>health_reg<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Life,life_expectancy<span class="sc">~</span>health_expenditure)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(health_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ health_expenditure, data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-16.366  -3.375   1.607   4.062  11.889 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         63.3056     1.5086  41.963  &lt; 2e-16 ***
health_expenditure   1.5208     0.2143   7.097 1.06e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.872 on 117 degrees of freedom
Multiple R-squared:  0.3009,    Adjusted R-squared:  0.2949 
F-statistic: 50.36 on 1 and 117 DF,  p-value: 1.058e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>co2_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> co2_emissions)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(co2_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ co2_emissions, data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.520  -4.654   1.473   4.424   9.790 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    70.2750     0.7773  90.408  &lt; 2e-16 ***
co2_emissions   0.6001     0.1048   5.725 8.12e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.207 on 117 degrees of freedom
Multiple R-squared:  0.2188,    Adjusted R-squared:  0.2122 
F-statistic: 32.78 on 1 and 117 DF,  p-value: 8.124e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># military_reg &lt;- lm(data = Life, life_expectancy ~ military_expenditure)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(military_reg)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>water_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Life, life_expectancy <span class="sc">~</span> people_using_at_least_basic_drinking_water_services)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(water_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ people_using_at_least_basic_drinking_water_services, 
    data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.1598  -2.5799  -0.1995   3.5155  10.0593 

Coefficients:
                                                    Estimate Std. Error t value
(Intercept)                                         38.79190    2.25750   17.18
people_using_at_least_basic_drinking_water_services  0.38500    0.02484   15.50
                                                    Pr(&gt;|t|)    
(Intercept)                                           &lt;2e-16 ***
people_using_at_least_basic_drinking_water_services   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.02 on 117 degrees of freedom
Multiple R-squared:  0.6724,    Adjusted R-squared:  0.6696 
F-statistic: 240.2 on 1 and 117 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>defacation_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> people_practicing_open_defecation)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(defacation_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ people_practicing_open_defecation, 
    data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.9851  -2.8896   0.4896   3.9707  12.1022 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                       75.66931    0.53405 141.690   &lt;2e-16 ***
people_practicing_open_defecation -0.34310    0.03495  -9.816   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.201 on 117 degrees of freedom
Multiple R-squared:  0.4516,    Adjusted R-squared:  0.4469 
F-statistic: 96.36 on 1 and 117 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>additive<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> co2_emissions <span class="sc">+</span> people_using_at_least_basic_drinking_water_services <span class="sc">+</span> people_practicing_open_defecation )</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(additive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    co2_emissions + people_using_at_least_basic_drinking_water_services + 
    people_practicing_open_defecation, data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.5264  -1.5707   0.1465   2.0469   7.6380 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                          4.802e+01  2.985e+00
gdp_per_capita                                       1.433e-04  2.721e-05
health_expenditure                                   4.673e-01  1.396e-01
co2_emissions                                       -1.838e-01  9.011e-02
people_using_at_least_basic_drinking_water_services  2.288e-01  3.384e-02
people_practicing_open_defecation                   -7.086e-02  3.288e-02
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          16.087  &lt; 2e-16 ***
gdp_per_capita                                        5.268 6.68e-07 ***
health_expenditure                                    3.348  0.00111 ** 
co2_emissions                                        -2.040  0.04368 *  
people_using_at_least_basic_drinking_water_services   6.761 6.32e-10 ***
people_practicing_open_defecation                    -2.156  0.03324 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.236 on 113 degrees of freedom
Multiple R-squared:  0.795, Adjusted R-squared:  0.7859 
F-statistic: 87.62 on 5 and 113 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>additive2<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> co2_emissions <span class="sc">+</span> people_using_at_least_basic_drinking_water_services )</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(additive2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    co2_emissions + people_using_at_least_basic_drinking_water_services, 
    data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.4944  -1.5239   0.0248   2.2403   8.1923 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                          4.324e+01  2.031e+00
gdp_per_capita                                       1.435e-04  2.764e-05
health_expenditure                                   4.548e-01  1.417e-01
co2_emissions                                       -1.769e-01  9.149e-02
people_using_at_least_basic_drinking_water_services  2.771e-01  2.574e-02
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          21.296  &lt; 2e-16 ***
gdp_per_capita                                        5.192 9.17e-07 ***
health_expenditure                                    3.210  0.00172 ** 
co2_emissions                                        -1.934  0.05562 .  
people_using_at_least_basic_drinking_water_services  10.767  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.287 on 114 degrees of freedom
Multiple R-squared:  0.7865,    Adjusted R-squared:  0.779 
F-statistic:   105 on 4 and 114 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>additive3<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> people_using_at_least_basic_drinking_water_services )</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(additive3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    people_using_at_least_basic_drinking_water_services, data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.607  -1.469   0.250   2.299   8.156 

Coefficients:
                                                     Estimate Std. Error
(Intercept)                                         4.332e+01  2.054e+00
gdp_per_capita                                      1.047e-04  1.923e-05
health_expenditure                                  5.384e-01  1.365e-01
people_using_at_least_basic_drinking_water_services 2.696e-01  2.575e-02
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          21.087  &lt; 2e-16 ***
gdp_per_capita                                        5.446 2.97e-07 ***
health_expenditure                                    3.944 0.000138 ***
people_using_at_least_basic_drinking_water_services  10.473  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.326 on 115 degrees of freedom
Multiple R-squared:  0.7795,    Adjusted R-squared:  0.7738 
F-statistic: 135.5 on 3 and 115 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>additive4<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> people_using_at_least_basic_drinking_water_services <span class="sc">+</span>least_developed)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(additive4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    people_using_at_least_basic_drinking_water_services + least_developed, 
    data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.377  -1.581   0.087   2.207   8.152 

Coefficients:
                                                     Estimate Std. Error
(Intercept)                                         3.771e+01  3.206e+00
gdp_per_capita                                      1.001e-04  1.900e-05
health_expenditure                                  5.492e-01  1.342e-01
people_using_at_least_basic_drinking_water_services 3.277e-01  3.616e-02
least_developedTRUE                                 3.128e+00  1.390e+00
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          11.764  &lt; 2e-16 ***
gdp_per_capita                                        5.269 6.55e-07 ***
health_expenditure                                    4.091 8.05e-05 ***
people_using_at_least_basic_drinking_water_services   9.063 4.20e-15 ***
least_developedTRUE                                   2.250   0.0264 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.269 on 114 degrees of freedom
Multiple R-squared:  0.7889,    Adjusted R-squared:  0.7815 
F-statistic: 106.5 on 4 and 114 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(additive4, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"ncv"</span>,<span class="st">"homogeneity"</span>,<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final-project-code_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>additive5<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> people_using_at_least_basic_drinking_water_services)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(additive5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    people_using_at_least_basic_drinking_water_services, data = Life)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.607  -1.469   0.250   2.299   8.156 

Coefficients:
                                                     Estimate Std. Error
(Intercept)                                         4.332e+01  2.054e+00
gdp_per_capita                                      1.047e-04  1.923e-05
health_expenditure                                  5.384e-01  1.365e-01
people_using_at_least_basic_drinking_water_services 2.696e-01  2.575e-02
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          21.087  &lt; 2e-16 ***
gdp_per_capita                                        5.446 2.97e-07 ***
health_expenditure                                    3.944 0.000138 ***
people_using_at_least_basic_drinking_water_services  10.473  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.326 on 115 degrees of freedom
Multiple R-squared:  0.7795,    Adjusted R-squared:  0.7738 
F-statistic: 135.5 on 3 and 115 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(additive5,additive4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services
Model 2: life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services + 
    least_developed
  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
1    115 1272.3                              
2    114 1218.2  1    54.089 5.0616 0.02638 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>interaction1<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">+</span> health_expenditure <span class="sc">+</span> people_using_at_least_basic_drinking_water_services <span class="sc">*</span>least_developed)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita + health_expenditure + 
    people_using_at_least_basic_drinking_water_services * least_developed, 
    data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.1847  -1.7316   0.1374   2.0552   7.7699 

Coefficients:
                                                                          Estimate
(Intercept)                                                              2.953e+01
gdp_per_capita                                                           8.132e-05
health_expenditure                                                       4.575e-01
people_using_at_least_basic_drinking_water_services                      4.263e-01
least_developedTRUE                                                      2.088e+01
people_using_at_least_basic_drinking_water_services:least_developedTRUE -2.488e-01
                                                                        Std. Error
(Intercept)                                                              3.846e+00
gdp_per_capita                                                           1.891e-05
health_expenditure                                                       1.307e-01
people_using_at_least_basic_drinking_water_services                      4.448e-02
least_developedTRUE                                                      5.231e+00
people_using_at_least_basic_drinking_water_services:least_developedTRUE  7.093e-02
                                                                        t value
(Intercept)                                                               7.679
gdp_per_capita                                                            4.302
health_expenditure                                                        3.501
people_using_at_least_basic_drinking_water_services                       9.583
least_developedTRUE                                                       3.991
people_using_at_least_basic_drinking_water_services:least_developedTRUE  -3.508
                                                                        Pr(&gt;|t|)
(Intercept)                                                             6.26e-12
gdp_per_capita                                                          3.62e-05
health_expenditure                                                      0.000666
people_using_at_least_basic_drinking_water_services                     2.81e-16
least_developedTRUE                                                     0.000117
people_using_at_least_basic_drinking_water_services:least_developedTRUE 0.000649
                                                                           
(Intercept)                                                             ***
gdp_per_capita                                                          ***
health_expenditure                                                      ***
people_using_at_least_basic_drinking_water_services                     ***
least_developedTRUE                                                     ***
people_using_at_least_basic_drinking_water_services:least_developedTRUE ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.118 on 113 degrees of freedom
Multiple R-squared:  0.8096,    Adjusted R-squared:  0.8012 
F-statistic: 96.12 on 5 and 113 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(additive4, interaction1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services + 
    least_developed
Model 2: life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services * 
    least_developed
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    114 1218.2                                  
2    113 1098.6  1    119.63 12.305 0.0006493 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(interaction1, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"ncv"</span>,<span class="st">"homogeneity"</span>,<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final-project-code_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(interaction1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     gdp_per_capita 
                                                           1.665213 
                                                 health_expenditure 
                                                           1.319098 
                people_using_at_least_basic_drinking_water_services 
                                                           5.328777 
                                                    least_developed 
                                                          38.985250 
people_using_at_least_basic_drinking_water_services:least_developed 
                                                          27.980547 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#high vif</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>interaction2<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data =</span> Life, life_expectancy <span class="sc">~</span> gdp_per_capita <span class="sc">*</span> least_developed<span class="sc">+</span> health_expenditure <span class="sc">+</span> people_using_at_least_basic_drinking_water_services)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy ~ gdp_per_capita * least_developed + 
    health_expenditure + people_using_at_least_basic_drinking_water_services, 
    data = Life)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.3217  -1.5802   0.2282   2.1481   7.5298 

Coefficients:
                                                      Estimate Std. Error
(Intercept)                                          3.688e+01  3.273e+00
gdp_per_capita                                       9.918e-05  1.898e-05
least_developedTRUE                                  5.188e+00  2.192e+00
health_expenditure                                   5.275e-01  1.352e-01
people_using_at_least_basic_drinking_water_services  3.385e-01  3.715e-02
gdp_per_capita:least_developedTRUE                  -5.838e-04  4.807e-04
                                                    t value Pr(&gt;|t|)    
(Intercept)                                          11.268  &lt; 2e-16 ***
gdp_per_capita                                        5.225 8.04e-07 ***
least_developedTRUE                                   2.367 0.019620 *  
health_expenditure                                    3.903 0.000162 ***
people_using_at_least_basic_drinking_water_services   9.110 3.49e-15 ***
gdp_per_capita:least_developedTRUE                   -1.214 0.227110    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.262 on 113 degrees of freedom
Multiple R-squared:  0.7916,    Adjusted R-squared:  0.7824 
F-statistic: 85.86 on 5 and 113 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(interaction2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     gdp_per_capita 
                                           1.533710 
                                    least_developed 
                                           6.250857 
                                 health_expenditure 
                                           1.288838 
people_using_at_least_basic_drinking_water_services 
                                           3.395829 
                     gdp_per_capita:least_developed 
                                           3.847824 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(additive4, interaction2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: life_expectancy ~ gdp_per_capita + health_expenditure + people_using_at_least_basic_drinking_water_services + 
    least_developed
Model 2: life_expectancy ~ gdp_per_capita * least_developed + health_expenditure + 
    people_using_at_least_basic_drinking_water_services
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1    114 1218.2                           
2    113 1202.5  1    15.695 1.4749 0.2271</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(interaction2, <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"ncv"</span>,<span class="st">"homogeneity"</span>,<span class="st">"qq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Final-project-code_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#high vif and insignificant interaction term</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#both interaction is not good </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>